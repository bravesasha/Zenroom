
# RSA

The implementation of the RSA signature scheme inside Zenroom is based on the RSASSA-PKCS1-v1_5 scheme described in Section 8.2 of [RFC8017](https://datatracker.ietf.org/doc/html/rfc8017).

In Zenroom, using the *Scenario rsa*, you will use the **RSA 4096** version, i.e., the value *n* in the keys must be 4096 bits. The public exponent *e* of the keys generated with Zenroom will always be 65537.

# Key Generation

## Private key

The script below generates a **RSA** private key.

[](../_media/examples/zencode_cookbook/rsa/alice_rsa_keygen.zen ':include :type=code gherkin')

The output should look like this:

[](../_media/examples/zencode_cookbook/rsa/alice_rsa_keys.json ':include :type=code json')



## Public key

Once you have created a private key, you can feed it to the following script to generate the **public key**:

[](../_media/examples/zencode_cookbook/rsa/alice_rsa_pubkey.zen ':include :type=code gherkin')

The output should look like this:

[](../_media/examples/zencode_cookbook/rsa/alice_rsa_pubkey.json ':include :type=code json')

# Signature

In this example we'll sign a simple message. Along with the data to be signed, we'll need the private key. The private key is in the file we have generated with the first script.

The script to **sign** this message look like this:

[](../_media/examples/zencode_cookbook/rsa/sign_rsa_from_alice.zen ':include :type=code gherkin')

And the output should look like this:

[](../_media/examples/zencode_cookbook/rsa/sign_rsa_alice_output.json ':include :type=code json')

# Verification

In this section we will **verify** the signature produced in the previous step. To carry out this task we would need the signature, the message and the signer public key. The signature and the message are contanined in the output of the last script, while the signer public key can be found in the output of the second script. So the input files should look like:

[](../_media/examples/zencode_cookbook/rsa/sign_rsa_alice_output.json ':include :type=code json')


[](../_media/examples/zencode_cookbook/rsa/alice_rsa_pubkey.json ':include :type=code json')

The script to verify these signatures is the following:

[](../_media/examples/zencode_cookbook/rsa/verify_rsa_from_alice.zen ':include :type=code gherkin')

The result should look like:

[](../_media/examples/zencode_cookbook/rsa/verify_rsa_alice_signature.json ':include :type=code json')

# The script used to create the material in this page

All the smart contracts and the data you see in this page are generated by the scripts [rsa.bats](https://github.com/dyne/Zenroom/blob/master/test/zencode/rsa.bats). If you want to run the scripts (on Linux) you should: 
 - *git clone https://github.com/dyne/Zenroom.git*
 - install  **jq**
 - download a [zenroom binary](https://zenroom.org/#downloads) and place it */bin* or */usr/bin* or in *./Zenroom/src*
